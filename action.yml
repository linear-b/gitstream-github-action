name: 'gitStream repo agent'
description: 'Public GitHub action for gitStream Continuous Merge'

inputs:
  full_repository:
    description: 'Path of full Repository'
    required: true
  head_ref:
    description: 'Head Branch Ref to checkout to'
    required: true
  base_ref:
    description: 'Base Branch Ref to checkout to'
    required: true
  client_payload:
    description: 'The client payload'
    required: true
  installation_id:
    description: 'The github app installation id'
    required: false
  resolver_url:
    description: 'Resolver url to send results to'
    required: true
  resolver_token:
    description: 'Optional token for resolver'
    required: false
  debug_mode:
    description: 'Run parser in debug mode'
    required: false
    default: 'false'

runs:
  using: composite
  steps:
    - uses: actions/setup-node@v4
      with:
        node-version: 20.12.2

    - uses: actions/setup-python@v5
      with:
        python-version: 3.x

    - name: Create GitStream folder
      shell: bash
      run: |
        rm -rf gitstream && rm -rf code && mkdir gitstream
        cd gitstream && mkdir repo

    - name: Checkout base branch
      uses: actions/checkout@v4
      with:
        repository: ${{ inputs.full_repository }}
        ref: ${{ inputs.base_ref }}
        path: gitstream/repo/
        token: ${{ fromJSON(fromJSON(inputs.client_payload)).githubToken || github.token }}

    - name: Escape single quotes
      id: safe-strings
      uses: actions/github-script@v7
      env:
        BASE_REF_ARG: ${{ inputs.base_ref }}
        HEAD_REF_ARG: ${{ inputs.head_ref }}
        PAYLOAD_ARG: ${{ inputs.client_payload }}
        URL_ARG: ${{ fromJSON(fromJSON(inputs.client_payload)).headHttpUrl || fromJSON(fromJSON(inputs.client_payload)).repoUrl }}
      with:
        script: |
          try {
            function convertToSafeString(input) {
              return (input || '').replace(/['`]/g, "\\$&");
            };
            function escapeApostrophe(input) {
              return (input || '').replace(/'/g, "\\'");
            };
            const base_ref = escapeApostrophe(process.env.BASE_REF_ARG);
            const head_ref = escapeApostrophe(process.env.HEAD_REF_ARG);
            const url = convertToSafeString(process.env.URL_ARG);
            const client_payload = convertToSafeString(process.env.PAYLOAD_ARG);
            core.setOutput('base_ref', base_ref);
            core.setOutput('head_ref', head_ref);
            core.setOutput('url', url);
            core.setOutput('client_payload', client_payload);
            core.setOutput('git_context', JSON.stringify({"branch":{"name":"LINBEE-9078","base":"main","author":"Yeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>","author_name":"Yeela Lifshitz\n","author_email":"<yeelalifshitz@Yeela-MacBook-Pro.local>","diff":{"size":1,"files_metadata":[{"original_file":"README.md","new_file":"README.md","file":"README.md","deletions":0,"additions":1}]},"num_of_commits":1,"commits":{"messages":["LINBEE-9078"]}},"source":{"diff":{"files":[{"original_file":"README.md","new_file":"README.md","diff":"@@ -32,3 +32,4 @@ To get more help on the Angular CLI use `ng help` or go check out the [Angular C\n Lady gaga the queen\n team flare :)\n bla bla bla\n+DASDASD\n\\ No newline at end of file","original_content":"# EuropeanPaintings\n\n![image](https://user-images.githubusercontent.com/52451294/131232589-06f209d5-ce33-48ff-aa3a-6e74fa0de637.png)\n\nThis project was generated with [Angular CLI](https://github.com/angular/angular-cli) version 12.2.3.\n\n## Development server\n\n1) Install Angular CLI: `npm install -g @angular/cli`\n2) Run `npm install`\n3) Run `ng serve` for a dev server. \n4) Navigate to `http://localhost:4200/`. The app will automatically reload.\n\n##Elad's history:\nI was born in 1990\nkjhgdkjhsdgfjk\ndasd\n## Further help\n\nTo get more help on the Angular CLI use `ng help` or go check out the [Angular CLI Overview and Command Reference](https://angular.io/cli) page.\n\n#PR\nTo get more help on the Angular CLI use `ng help` or go check out the [Angular CLI Overview and Command Reference](https://angular.io/cli) page.\n\n#PRTo get more help on the Angular CLI use `ng help` or go check out the [Angular CLI Overview and Command Reference](https://angular.io/cli) page.\n\n#PRTo get more help on the Angular CLI use `ng help` or go check out the [Angular CLI Overview and Command Reference](https://angular.io/cli) page.\n\n#PRTo get more help on the Angular CLI use `ng help` or go check out the [Angular CLI Overview and Command Reference](https://angular.io/cli) page.\n\n#PR\nLady gaga the queen\nteam flare :)\nbla bla bla\n","new_content":"# EuropeanPaintings\n\n![image](https://user-images.githubusercontent.com/52451294/131232589-06f209d5-ce33-48ff-aa3a-6e74fa0de637.png)\n\nThis project was generated with [Angular CLI](https://github.com/angular/angular-cli) version 12.2.3.\n\n## Development server\n\n1) Install Angular CLI: `npm install -g @angular/cli`\n2) Run `npm install`\n3) Run `ng serve` for a dev server. \n4) Navigate to `http://localhost:4200/`. The app will automatically reload.\n\n##Elad's history:\nI was born in 1990\nkjhgdkjhsdgfjk\ndasd\n## Further help\n\nTo get more help on the Angular CLI use `ng help` or go check out the [Angular CLI Overview and Command Reference](https://angular.io/cli) page.\n\n#PR\nTo get more help on the Angular CLI use `ng help` or go check out the [Angular CLI Overview and Command Reference](https://angular.io/cli) page.\n\n#PRTo get more help on the Angular CLI use `ng help` or go check out the [Angular CLI Overview and Command Reference](https://angular.io/cli) page.\n\n#PRTo get more help on the Angular CLI use `ng help` or go check out the [Angular CLI Overview and Command Reference](https://angular.io/cli) page.\n\n#PRTo get more help on the Angular CLI use `ng help` or go check out the [Angular CLI Overview and Command Reference](https://angular.io/cli) page.\n\n#PR\nLady gaga the queen\nteam flare :)\nbla bla bla\nDASDASD"}]}},"repo":{"name":"EuropeanPaintings","contributors":{"Yeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>":839,"Yeela Lifshitz <yeelalifshitz@MacBook-Pro-8.local>":252,"Yeela Lifshitz <yeelalifshitz@MacBook-Pro.local>":227,"Yeela Lifshitz <52451294+yeelali14@users.noreply.github.com>":45,"gitstream-cm[bot] <111687743+gitstream-cm[bot]@users.noreply.github.com>":11,"gitstream-dev-01[bot] <111136706+gitstream-dev-01[bot]@users.noreply.github.com>":11,"shaked zohar <shaked.zrihen@gmail.com>":6,"Luke Kilpatrick <lukekilpat@gmail.com>":5,"Yeela Lifshitz <yeelalifshitz@Yeela-MBP.lan>":4,"Elad Kohavi <106978846+EladKohavi@users.noreply.github.com>":3,"Yeela Lifshitz <yeelalifshitz@Yeelas-MacBook-Pro.local>":3,"yeelali14 <52451294+yeelali14@users.noreply.github.com>":3,"Yeela <yeela@gitatechnologies.com>":2,"EladKohavi <106978846+EladKohavi@users.noreply.github.com>":1,"Luke Kilpatrick <luke@lukek.ca>":1,"Yaara Shoham <yaara.shohamd@gmail.com>":1,"kodiakhq[bot] <49736102+kodiakhq[bot]@users.noreply.github.com>":1},"owner":"yeelali14","visibility":"public","provider":"github","git_to_provider_user":{"Yeela Lifshitz <52451294+yeelali14@users.noreply.github.com>":"yeelali14","Elad Kohavi <106978846+EladKohavi@users.noreply.github.com>":"EladKohavi","yeelali14 <52451294+yeelali14@users.noreply.github.com>":"yeelali14","EladKohavi <106978846+EladKohavi@users.noreply.github.com>":"EladKohavi","Yaara Shoham <yaara.shohamd@gmail.com>":"Yaarash","Yeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>":"yeelali14","Yeela Lifshitz <yeelalifshitz@MacBook-Pro-8.local>":"yeelali14","Yeela Lifshitz <yeelalifshitz@MacBook-Pro.local>":"yeelali14","shaked zohar <shaked.zrihen@gmail.com>":"ShakedZrihen","Luke Kilpatrick <lukekilpat@gmail.com>":"lkilpatrick","Yeela Lifshitz <yeelalifshitz@Yeela-MBP.lan>":"yeelali14","Yeela Lifshitz <yeelalifshitz@Yeelas-MacBook-Pro.local>":"yeelali14","Luke Kilpatrick <luke@lukek.ca>":"lkilpatrick","gitstream-cm[bot] <111687743+gitstream-cm[bot]@users.noreply.github.com>":"gitstream-cm[bot] <111687743+gitstream-cm[bot]@users.noreply.github.com>","gitstream-dev-01[bot] <111136706+gitstream-dev-01[bot]@users.noreply.github.com>":"gitstream-dev-01[bot] <111136706+gitstream-dev-01[bot]@users.noreply.github.com>","Yeela <yeela@gitatechnologies.com>":"Yeela <yeela@gitatechnologies.com>","kodiakhq[bot] <49736102+kodiakhq[bot]@users.noreply.github.com>":"kodiakhq[bot] <49736102+kodiakhq[bot]@users.noreply.github.com>"},"age":1053,"author_age":434,"blame":{"README.md":{"Yeela <yeela@gitatechnologies.com>":29.411764705882355,"yeelali14 <52451294+yeelali14@users.noreply.github.com>":17.647058823529413,"EladKohavi <106978846+EladKohavi@users.noreply.github.com>":5.88235294117647,"Elad Kohavi <106978846+EladKohavi@users.noreply.github.com>":23.52941176470588,"Yeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>":14.705882352941178,"Yeela Lifshitz <52451294+yeelali14@users.noreply.github.com>":8.823529411764707}},"git_activity":{"README.md":{"Yeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>":{"week_3":6,"week_7":15,"week_8":4,"week_20":24,"week_22":3,"week_24":61,"week_25":1,"week_27":52,"week_28":3,"week_41":12,"week_43":12,"week_45":7},"Yeela Lifshitz <yeelalifshitz@Yeela-MBP.lan>":{"week_24":1}}},"pr_author":"yeelali14","data_service":{"expert_reviwer_request":{"merge_dict":{"Yeela Lifshitz <52451294+yeelali14@users.noreply.github.com>":"yeelali14","Elad Kohavi <106978846+EladKohavi@users.noreply.github.com>":"EladKohavi","yeelali14 <52451294+yeelali14@users.noreply.github.com>":"yeelali14","EladKohavi <106978846+EladKohavi@users.noreply.github.com>":"EladKohavi","Yaara Shoham <yaara.shohamd@gmail.com>":"Yaarash","Yeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>":"yeelali14","Yeela Lifshitz <yeelalifshitz@MacBook-Pro-8.local>":"yeelali14","Yeela Lifshitz <yeelalifshitz@MacBook-Pro.local>":"yeelali14","shaked zohar <shaked.zrihen@gmail.com>":"ShakedZrihen","Luke Kilpatrick <lukekilpat@gmail.com>":"lkilpatrick","Yeela Lifshitz <yeelalifshitz@Yeela-MBP.lan>":"yeelali14","Yeela Lifshitz <yeelalifshitz@Yeelas-MacBook-Pro.local>":"yeelali14","Luke Kilpatrick <luke@lukek.ca>":"lkilpatrick","gitstream-cm[bot] <111687743+gitstream-cm[bot]@users.noreply.github.com>":"gitstream-cm[bot] <111687743+gitstream-cm[bot]@users.noreply.github.com>","gitstream-dev-01[bot] <111136706+gitstream-dev-01[bot]@users.noreply.github.com>":"gitstream-dev-01[bot] <111136706+gitstream-dev-01[bot]@users.noreply.github.com>","Yeela <yeela@gitatechnologies.com>":"Yeela <yeela@gitatechnologies.com>","kodiakhq[bot] <49736102+kodiakhq[bot]@users.noreply.github.com>":"kodiakhq[bot] <49736102+kodiakhq[bot]@users.noreply.github.com>"},"pr_files":{"README.md":{"blame":"author Yeela author-mail <yeela@gitatechnologies.com>\nauthor Yeela author-mail <yeela@gitatechnologies.com>\nauthor yeelali14 author-mail <52451294+yeelali14@users.noreply.github.com>\nauthor yeelali14 author-mail <52451294+yeelali14@users.noreply.github.com>\nauthor Yeela author-mail <yeela@gitatechnologies.com>\nauthor Yeela author-mail <yeela@gitatechnologies.com>\nauthor Yeela author-mail <yeela@gitatechnologies.com>\nauthor Yeela author-mail <yeela@gitatechnologies.com>\nauthor yeelali14 author-mail <52451294+yeelali14@users.noreply.github.com>\nauthor yeelali14 author-mail <52451294+yeelali14@users.noreply.github.com>\nauthor yeelali14 author-mail <52451294+yeelali14@users.noreply.github.com>\nauthor yeelali14 author-mail <52451294+yeelali14@users.noreply.github.com>\nauthor Yeela author-mail <yeela@gitatechnologies.com>\nauthor EladKohavi author-mail <106978846+EladKohavi@users.noreply.github.com>\nauthor EladKohavi author-mail <106978846+EladKohavi@users.noreply.github.com>\nauthor Elad Kohavi author-mail <106978846+EladKohavi@users.noreply.github.com>\nauthor Yeela Lifshitz author-mail <yeelalifshitz@Yeela-MacBook-Pro.local>\nauthor Yeela author-mail <yeela@gitatechnologies.com>\nauthor Yeela author-mail <yeela@gitatechnologies.com>\nauthor Yeela author-mail <yeela@gitatechnologies.com>\nauthor Yeela Lifshitz author-mail <52451294+yeelali14@users.noreply.github.com>\nauthor Yeela Lifshitz author-mail <52451294+yeelali14@users.noreply.github.com>\nauthor Elad Kohavi author-mail <106978846+EladKohavi@users.noreply.github.com>\nauthor Elad Kohavi author-mail <106978846+EladKohavi@users.noreply.github.com>\nauthor Elad Kohavi author-mail <106978846+EladKohavi@users.noreply.github.com>\nauthor Elad Kohavi author-mail <106978846+EladKohavi@users.noreply.github.com>\nauthor Elad Kohavi author-mail <106978846+EladKohavi@users.noreply.github.com>\nauthor Yeela Lifshitz author-mail <52451294+yeelali14@users.noreply.github.com>\nauthor Elad Kohavi author-mail <106978846+EladKohavi@users.noreply.github.com>\nauthor Elad Kohavi author-mail <106978846+EladKohavi@users.noreply.github.com>\nauthor Yeela Lifshitz author-mail <yeelalifshitz@Yeela-MacBook-Pro.local>\nauthor Yeela Lifshitz author-mail <yeelalifshitz@Yeela-MacBook-Pro.local>\nauthor Yeela Lifshitz author-mail <yeelalifshitz@Yeela-MacBook-Pro.local>\nauthor Yeela Lifshitz author-mail <yeelalifshitz@Yeela-MacBook-Pro.local>\n","activity":"Yeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jun 24 17:08:28 2024 +0300\n\n0\t3\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jun 24 13:40:48 2024 +0300\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Sun May 26 21:52:20 2024 +0300\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Sun May 26 21:20:25 2024 +0300\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Sun May 26 21:07:53 2024 +0300\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Sun May 26 20:41:16 2024 +0300\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Sun May 26 20:33:54 2024 +0300\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Sun May 26 17:29:57 2024 +0300\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu May 23 14:36:47 2024 +0300\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu May 16 00:00:50 2024 +0300\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Wed May 15 16:33:14 2024 +0300\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Feb 27 23:09:41 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Feb 27 21:46:07 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Feb 27 21:36:00 2024 +0200\n\n1\t0\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Sun Feb 25 20:06:17 2024 +0200\n\n0\t2\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Feb 22 23:43:41 2024 +0200\n\n1\t2\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Feb 22 23:01:26 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Feb 22 22:16:55 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Feb 22 17:34:36 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Feb 22 17:18:53 2024 +0200\n\n2\t0\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Feb 22 15:01:11 2024 +0200\n\n0\t2\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Feb 22 13:43:35 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Feb 12 15:18:18 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 30 14:36:34 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 30 14:11:16 2024 +0200\n\n1\t2\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 30 13:55:36 2024 +0200\n\n1\t0\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 30 13:38:16 2024 +0200\n\n0\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 30 13:25:12 2024 +0200\n\n1\t0\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 30 13:06:29 2024 +0200\n\n0\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jan 29 11:29:06 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MBP.lan>,Sat Jan 27 15:47:39 2024 +0200\n\n1\t0\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Sat Jan 27 11:46:25 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Fri Jan 26 17:36:52 2024 +0200\n\n0\t2\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Jan 25 22:23:58 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Jan 25 19:42:44 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Jan 25 19:37:26 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Jan 25 19:31:00 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Jan 25 19:22:18 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Jan 25 18:08:54 2024 +0200\n\n1\t0\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Jan 25 18:04:25 2024 +0200\n\n0\t2\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Jan 25 18:00:43 2024 +0200\n\n1\t5\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Jan 25 15:29:18 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Wed Jan 24 21:15:05 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Wed Jan 24 20:47:15 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Wed Jan 24 20:24:30 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Wed Jan 24 18:48:27 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Wed Jan 24 18:13:30 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Wed Jan 24 18:06:46 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Wed Jan 24 17:22:53 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Wed Jan 24 16:42:39 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Wed Jan 24 13:05:52 2024 +0200\n\n2\t2\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Wed Jan 24 13:02:47 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jan 22 18:15:05 2024 +0200\n\n1\t0\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 9 17:19:19 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 9 15:03:16 2024 +0200\n\n1\t5\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 9 12:07:59 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 9 11:58:01 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 9 11:04:22 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 9 10:58:50 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 9 01:15:30 2024 +0200\n\n3\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 9 00:15:05 2024 +0200\n\n1\t4\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 9 00:11:10 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jan 8 23:59:18 2024 +0200\n\n3\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jan 8 23:40:42 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jan 8 23:09:25 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jan 8 22:38:17 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jan 8 22:31:31 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jan 8 22:26:20 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jan 8 22:01:15 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jan 8 20:03:53 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Mon Jan 8 20:00:38 2024 +0200\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Jan 2 13:09:53 2024 +0200\n\n2\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Oct 3 18:10:46 2023 +0300\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Oct 3 18:05:59 2023 +0300\n\n1\t0\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Oct 3 18:01:22 2023 +0300\n\n0\t9\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Sep 14 20:43:42 2023 +0300\n\n6\t0\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Sep 14 20:35:42 2023 +0300\n\n0\t2\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Thu Sep 14 20:00:58 2023 +0300\n\n4\t0\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Sep 5 20:47:41 2023 +0300\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Sep 5 18:57:07 2023 +0300\n\n1\t0\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Sep 5 18:31:30 2023 +0300\n\n0\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Sep 5 17:51:18 2023 +0300\n\n1\t1\tREADME.md\nYeela Lifshitz <yeelalifshitz@Yeela-MacBook-Pro.local>,Tue Sep 5 13:02:24 2023 +0300\n\n1\t0\tREADME.md\n"}},"context":{"org":"yeelali14","repo":"EuropeanPaintings","pullRequestNumber":1259,"branch":"LINBEE-9078","triggeredBy":"yeelali14"}}}},"files":["README.md"],"pr":{"author":"yeelali14","title":"LINBEE-9078","number":1259,"created_at":"2024-07-16T08:15:02Z","updated_at":"2024-07-16T08:15:02Z","description":"","draft":false,"status":"open","url":"https://github.com/yeelali14/EuropeanPaintings/pull/1259","contributors":[{"login":"lkilpatrick","name":"Luke Kilpatrick"},{"login":"Yaarash","name":"Yaara Shoham"},{"login":"ShakedZrihen","name":"shaked zohar"},{"login":"yeelali14","name":"Yeela Lifshitz"},{"login":"paparoach14","name":null},{"login":"ShaniBelisha","name":"Shani"},{"login":"EladKohavi","name":"Elad Kohavi"}],"author_teams":[],"author_is_org_member":true,"approvals":[],"assignees":[],"comments":[],"conversations":[],"labels":[],"reviewers":[],"isFullyInstalled":true,"mergeable":true,"reviews":[],"checks":[],"source":"LINBEE-9078","target":"main","repo":"EuropeanPaintings","conflicted_files_count":0},"env":{"SELENIUM_JAR_PATH":"/usr/share/java/selenium-server.jar","DEBUG_MODE":"true","CONDA":"/usr/share/miniconda","GITHUB_WORKSPACE":"/home/runner/work/EuropeanPaintings/EuropeanPaintings","JAVA_HOME_11_X64":"/usr/lib/jvm/temurin-11-jdk-amd64","PKG_CONFIG_PATH":"/opt/hostedtoolcache/Python/3.12.4/x64/lib/pkgconfig","RULES_RESOLVER_URL":"https://yho0owet1b.execute-api.us-west-1.amazonaws.com/dev-01/api/v1/gitstream/resolve?qPostfix=yeela","GITHUB_PATH":"/home/runner/work/_temp/_runner_file_commands/add_path_a40bad8a-eb4e-4a1b-bc8d-cf88dabd2686","GITHUB_ACTION":"rules-engine","JAVA_HOME":"/usr/lib/jvm/temurin-11-jdk-amd64","GITHUB_RUN_NUMBER":"4199","RUNNER_NAME":"GitHub Actions 1","GRADLE_HOME":"/usr/share/gradle-8.8","GITHUB_REPOSITORY_OWNER_ID":"52451294","ACTIONS_RUNNER_ACTION_ARCHIVE_CACHE":"/opt/actionarchivecache","XDG_CONFIG_HOME":"/home/runner/.config","Python_ROOT_DIR":"/opt/hostedtoolcache/Python/3.12.4/x64","DOTNET_SKIP_FIRST_TIME_EXPERIENCE":"1","ANT_HOME":"/usr/share/ant","JAVA_HOME_8_X64":"/usr/lib/jvm/temurin-8-jdk-amd64","GITHUB_TRIGGERING_ACTOR":"gitstream-daveloper[bot]","pythonLocation":"/opt/hostedtoolcache/Python/3.12.4/x64","GITHUB_REF_TYPE":"branch","HOMEBREW_CLEANUP_PERIODIC_FULL_DAYS":"3650","ANDROID_NDK":"/usr/local/lib/android/sdk/ndk/25.2.9519653","BOOTSTRAP_HASKELL_NONINTERACTIVE":"1","PWD":"/home/runner/work/EuropeanPaintings/EuropeanPaintings","PIPX_BIN_DIR":"/opt/pipx_bin","STATS_TRP":"true","STATS_BLT":"true","GOROOT_1_20_X64":"/opt/hostedtoolcache/go/1.20.14/x64","GITHUB_REPOSITORY_ID":"400902592","DEPLOYMENT_BASEPATH":"/opt/runner","GITHUB_ACTIONS":"true","STATS_VMD":"true","ANDROID_NDK_LATEST_HOME":"/usr/local/lib/android/sdk/ndk/26.3.11579264","SYSTEMD_EXEC_PID":"588","GITHUB_SHA":"09f5103846f832bc7a7c766aa22a1202e1308da1","GITHUB_WORKFLOW_REF":"yeelali14/EuropeanPaintings/.github/workflows/gitstream.yml@refs/heads/LINBEE-9078","POWERSHELL_DISTRIBUTION_CHANNEL":"GitHub-Actions-ubuntu22","RUNNER_ENVIRONMENT":"github-hosted","STATS_EXTP":"https://provjobdsettingscdn.blob.core.windows.net/settings/provjobdsettings-0.5.181+6/provjobd.data","DOTNET_MULTILEVEL_LOOKUP":"0","GITHUB_REF":"refs/heads/LINBEE-9078","CLIENT_PAYLOAD":"\"{\\\"sensorAuthId\\\":null,\\\"organizationId\\\":null,\\\"repoPath\\\":\\\".github/workflows/gitstream.yml\\\",\\\"gitstream_jwt_token\\\":\\\"\\\",\\\"gitstreamGatesCheckId\\\":27496136317,\\\"repo\\\":\\\"EuropeanPaintings\\\",\\\"owner\\\":\\\"yeelali14\\\",\\\"branch\\\":\\\"LINBEE-9078\\\",\\\"installationId\\\":52228684,\\\"pullRequestNumber\\\":1259,\\\"headSha\\\":\\\"09f5103846f832bc7a7c766aa22a1202e1308da1\\\",\\\"baseRef\\\":\\\"main\\\",\\\"baseSha\\\":\\\"d5fbd73c4b064bf2253a97485cc79cb51ed1a9d4\\\",\\\"visibility\\\":\\\"public\\\",\\\"triggeredBy\\\":\\\"yeelali14\\\",\\\"triggeredPREvent\\\":\\\"opened\\\",\\\"source\\\":\\\"github\\\",\\\"env\\\":\\\"dev-01\\\",\\\"creator\\\":\\\"yeelali14\\\",\\\"analytics_url\\\":\\\"https://webhooks.gitstream-dev.cm/analytics\\\",\\\"analyticsHttpApiUrl\\\":\\\"https://api.amplitude.com/2/httpapi\\\",\\\"segmentServiceUrl\\\":\\\"https://api.segment.io\\\",\\\"prContext\\\":{\\\"author\\\":\\\"yeelali14\\\",\\\"title\\\":\\\"LINBEE-9078\\\",\\\"number\\\":1259,\\\"created_at\\\":\\\"2024-07-16T08:15:02Z\\\",\\\"updated_at\\\":\\\"2024-07-16T08:15:02Z\\\",\\\"description\\\":\\\"\\\",\\\"draft\\\":false,\\\"status\\\":\\\"open\\\",\\\"url\\\":\\\"https://github.com/yeelali14/EuropeanPaintings/pull/1259\\\",\\\"contributors\\\":[{\\\"login\\\":\\\"lkilpatrick\\\",\\\"name\\\":\\\"Luke Kilpatrick\\\"},{\\\"login\\\":\\\"Yaarash\\\",\\\"name\\\":\\\"Yaara Shoham\\\"},{\\\"login\\\":\\\"ShakedZrihen\\\",\\\"name\\\":\\\"shaked zohar\\\"},{\\\"login\\\":\\\"yeelali14\\\",\\\"name\\\":\\\"Yeela Lifshitz\\\"},{\\\"login\\\":\\\"paparoach14\\\",\\\"name\\\":null},{\\\"login\\\":\\\"ShaniBelisha\\\",\\\"name\\\":\\\"Shani\\\"},{\\\"login\\\":\\\"EladKohavi\\\",\\\"name\\\":\\\"Elad Kohavi\\\"}],\\\"author_teams\\\":[],\\\"author_is_org_member\\\":true,\\\"approvals\\\":[],\\\"assignees\\\":[],\\\"comments\\\":[],\\\"conversations\\\":[],\\\"labels\\\":[],\\\"reviewers\\\":[],\\\"isFullyInstalled\\\":true,\\\"mergeable\\\":true,\\\"reviews\\\":[],\\\"checks\\\":[],\\\"source\\\":\\\"LINBEE-9078\\\",\\\"target\\\":\\\"main\\\"},\\\"hasCmRepo\\\":false,\\\"providerRepoId\\\":400902592,\\\"isNewCommit\\\":true,\\\"trigger_id\\\":\\\"1aa09aef-c76b-4b34-bc9d-e2f4c5a06b32\\\",\\\"headHttpUrl\\\":\\\"https://github.com/yeelali14/EuropeanPaintings\\\",\\\"explicitTriggers\\\":{\\\".cm/8419.cm\\\":{\\\"shouldBeTriggered\\\":true}},\\\"webhookEventName\\\":\\\"pull_request_opened\\\",\\\"webhookEventNames\\\":{\\\"pull_request_opened\\\":true},\\\"githubToken\\\":\\\"***\\\",\\\"eventAction\\\":\\\"opened\\\",\\\"mergeCommitSha\\\":null}\"","RUNNER_OS":"Linux","GITHUB_REF_PROTECTED":"false","HOME":"/home/runner","GITHUB_API_URL":"https://api.github.com","LANG":"C.UTF-8","RUNNER_TRACKING_ID":"github_50f18040-e3a8-466a-975f-a01433694c4a","RUNNER_ARCH":"X64","GOROOT_1_21_X64":"/opt/hostedtoolcache/go/1.21.12/x64","RUNNER_TEMP":"/home/runner/work/_temp","GITHUB_STATE":"/home/runner/work/_temp/_runner_file_commands/save_state_a40bad8a-eb4e-4a1b-bc8d-cf88dabd2686","EDGEWEBDRIVER":"/usr/local/share/edge_driver","JAVA_HOME_21_X64":"/usr/lib/jvm/temurin-21-jdk-amd64","GITHUB_ENV":"/home/runner/work/_temp/_runner_file_commands/set_env_a40bad8a-eb4e-4a1b-bc8d-cf88dabd2686","GITHUB_EVENT_PATH":"/home/runner/work/_temp/_github_workflow/event.json","INVOCATION_ID":"618dda67df9147b38722847797dfc435","STATS_D":"true","GITHUB_EVENT_NAME":"workflow_dispatch","GITHUB_RUN_ID":"9953202409","JAVA_HOME_17_X64":"/usr/lib/jvm/temurin-17-jdk-amd64","ANDROID_NDK_HOME":"/usr/local/lib/android/sdk/ndk/25.2.9519653","GITHUB_STEP_SUMMARY":"/home/runner/work/_temp/_runner_file_commands/step_summary_a40bad8a-eb4e-4a1b-bc8d-cf88dabd2686","HOMEBREW_NO_AUTO_UPDATE":"1","GITHUB_ACTOR":"gitstream-daveloper[bot]","NVM_DIR":"/home/runner/.nvm","SGX_AESM_ADDR":"1","GITHUB_RUN_ATTEMPT":"1","STATS_RDCL":"true","ANDROID_HOME":"/usr/local/lib/android/sdk","SLACK_DEV_WEBHOOK":"***","GITHUB_GRAPHQL_URL":"https://api.github.com/graphql","ACCEPT_EULA":"Y","RUNNER_USER":"runner","BASE_REF":"main","STATS_UE":"true","USER":"runner","GITHUB_ACTION_PATH":"/home/runner/work/_actions/linear-b/gitstream-github-action/LINBEE-9078-1","GITHUB_SERVER_URL":"https://github.com","STATS_V3PS":"true","PIPX_HOME":"/opt/pipx","RULES_RESOLVER_TOKEN":"***","GECKOWEBDRIVER":"/usr/local/share/gecko_driver","STATS_EXT":"true","CHROMEWEBDRIVER":"/usr/local/share/chromedriver-linux64","SHLVL":"1","ANDROID_SDK_ROOT":"/usr/local/lib/android/sdk","VCPKG_INSTALLATION_ROOT":"/usr/local/share/vcpkg","GITHUB_ACTOR_ID":"166713803","RUNNER_TOOL_CACHE":"/opt/hostedtoolcache","ImageVersion":"20240708.1.0","Python3_ROOT_DIR":"/opt/hostedtoolcache/Python/3.12.4/x64","DOTNET_NOLOGO":"1","GITHUB_WORKFLOW_SHA":"09f5103846f832bc7a7c766aa22a1202e1308da1","GITHUB_REF_NAME":"LINBEE-9078","GITHUB_JOB":"gitStream","LD_LIBRARY_PATH":"/opt/hostedtoolcache/Python/3.12.4/x64/lib","XDG_RUNTIME_DIR":"/run/user/1001","AZURE_EXTENSION_DIR":"/opt/az/azcliextensions","PERFLOG_LOCATION_SETTING":"RUNNER_PERFLOG","STATS_VMFE":"true","GITHUB_REPOSITORY":"yeelali14/EuropeanPaintings","Python2_ROOT_DIR":"/opt/hostedtoolcache/Python/3.12.4/x64","GOROOT_1_22_X64":"/opt/hostedtoolcache/go/1.22.5/x64","ANDROID_NDK_ROOT":"/usr/local/lib/android/sdk/ndk/25.2.9519653","CHROME_BIN":"/usr/bin/google-chrome","GITHUB_RETENTION_DAYS":"90","JOURNAL_STREAM":"8:20534","RUNNER_WORKSPACE":"/home/runner/work/EuropeanPaintings","LEIN_HOME":"/usr/local/lib/lein","LEIN_JAR":"/usr/local/lib/lein/self-installs/leiningen-2.11.2-standalone.jar","GITHUB_ACTION_REPOSITORY":"","PATH":"/opt/hostedtoolcache/Python/3.12.4/x64/bin:/opt/hostedtoolcache/Python/3.12.4/x64:/opt/hostedtoolcache/node/20.12.2/x64/bin:/snap/bin:/home/runner/.local/bin:/opt/pipx_bin:/home/runner/.cargo/bin:/home/runner/.config/composer/vendor/bin:/usr/local/.ghcup/bin:/home/runner/.dotnet/tools:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin","RUNNER_PERFLOG":"/home/runner/perflog","GITHUB_BASE_REF":"","GHCUP_INSTALL_BASE_PREFIX":"/usr/local","CI":"true","SWIFT_PATH":"/usr/share/swift/usr/bin","ImageOS":"ubuntu22","STATS_D_D":"true","GITHUB_REPOSITORY_OWNER":"yeelali14","GITHUB_HEAD_REF":"","GITHUB_ACTION_REF":"","GITHUB_WORKFLOW":"gitStream workflow automation","DEBIAN_FRONTEND":"noninteractive","GITHUB_OUTPUT":"/home/runner/work/_temp/_runner_file_commands/set_output_a40bad8a-eb4e-4a1b-bc8d-cf88dabd2686","AGENT_TOOLSDIRECTORY":"/opt/hostedtoolcache","HEAD_REF":"LINBEE-9078","_":"/opt/hostedtoolcache/node/20.12.2/x64/bin/node"}}));
          } catch (err) {
            core.error(`Failed producing safe string: ${err}`);
            process.exit(1);
          }

    - name: Checkout Pull Request branches history
      shell: bash
      run: |
        ALL=2147483647
        cd gitstream && cd repo
        git fetch --deepen=$ALL origin $'${{ steps.safe-strings.outputs.base_ref }}'
        git remote add upstream $'${{ steps.safe-strings.outputs.url }}'
        git fetch --deepen=$ALL upstream $'${{ steps.safe-strings.outputs.head_ref }}'
        git checkout -b $'upstream/${{ steps.safe-strings.outputs.head_ref}}' $'upstream/${{ steps.safe-strings.outputs.head_ref}}'
        git checkout $'${{ steps.safe-strings.outputs.base_ref }}'
        git checkout $'${{ steps.safe-strings.outputs.head_ref }}'

    - name: Create cm folder
      shell: bash
      run: cd gitstream && mkdir cm

    - name: Checkout cm repo
      uses: actions/checkout@v4
      if: ${{ fromJSON(fromJSON(inputs.client_payload)).hasCmRepo == true }}
      with:
        repository: '${{ fromJSON(fromJSON(inputs.client_payload)).owner }}/${{ fromJSON(fromJSON(inputs.client_payload)).cmRepo }}'
        ref: ${{ fromJSON(fromJSON(inputs.client_payload)).cmRepoRef }}
        path: gitstream/cm/

    - name: Volume folder
      shell: bash
      run: mv gitstream code

    - name: Install Dependencies for plugins
      shell: bash
      run: npm i --silent moment lodash axios @octokit/rest

    - name: Run RulesEngine
      shell: bash
      run: node ${{ github.action_path }}/dist/index.js
      env:
        HEAD_REF: ${{ steps.safe-strings.outputs.head_ref }}
        BASE_REF: ${{ steps.safe-strings.outputs.base_ref }}
        CLIENT_PAYLOAD: ${{ steps.safe-strings.outputs.client_payload }}
        RULES_RESOLVER_URL: ${{ inputs.resolver_url }}
        RULES_RESOLVER_TOKEN: ${{ inputs.resolver_token }}
        DEBUG_MODE: ${{ inputs.debug_mode }}
        GIT_CONTEXT: ${{ steps.safe-strings.outputs.git_context }}
        SHOULD_USE_CACHE: true
